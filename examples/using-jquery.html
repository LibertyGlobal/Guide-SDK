<!DOCTYPE html>
<html>
  <head lang="en">
    <meta charset="UTF-8">
    <title>LGI Guide</title>

    <style>
      body {
        box-sizing: border-box;
        width: 600px;
        margin: 50px auto;
        padding: 0;
        background: #111;
        color: #ccc;
        font: 16px/1.5 Helvetica, Arial, sans-serif;
      }

      h1, h2, h3, h4 {
        font-weight: normal;
        color: #fff;
      }

      li.error {
        color: #a00000;
      }
    </style>
  </head>
  <body>
    <ul id="main"></ul>

    <script id="data-template" type="text/html">
      <% _.each(items, function (item) { %>
      <li>
        <strong><%= item.video.title %></strong> is on at <%= new Date(item.start).toLocaleString() %>
      </li>
      <% }); %>
    </script>

    <script id="error-template" type="text/html">
      <li class="error">An error has occurred while retrieving the data</li>
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/2.4.1/lodash.min.js"></script>
    <script src="https://code.jquery.com/jquery-1.11.2.min.js"></script>
    <script src="../dist/lgi-guide-jquery.js"></script>

    <script>
      LGI.Guide.initialize({
        region: 'NL',
        appId: 'demo',
        appKey: 'demo'
      });

      LGI.Guide.findBroadcasts()
          .fields(LGI.Guide.Video.TITLE, LGI.Guide.Broadcast.START, LGI.Guide.Channel.NAME)
          .filter(LGI.Guide.Channel.POSITION.isEqualTo(5))
          .sortBy(LGI.Guide.Broadcast.START)
          .limit(3)
          .execute(onSuccess);

      var main = document.getElementById('main');
      var dataTemplate = _.template(document.getElementById('data-template').textContent);
      var errorTemplate = _.template(document.getElementById('error-template').textContent);

      function onSuccess(response) {
        main.innerHTML = dataTemplate({ items: response.data });
      }

      function onError() {
        main.innerHTML = errorTemplate();
      }
    </script>

  </body>
</html>
